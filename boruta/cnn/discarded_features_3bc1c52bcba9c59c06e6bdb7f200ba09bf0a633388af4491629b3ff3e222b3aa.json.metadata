{
    "creation_time": 1639674577.5645125,
    "creation_time_human": "2021-12-16 17:09:37",
    "time_delta": 533.0173604488373,
    "time_delta_human": "8 minutes and 53 seconds",
    "file_dump_time": 0.0042421817779541016,
    "file_dump_time_human": "0 seconds",
    "file_dump_size": 2,
    "file_dump_size_human": "2 Bytes",
    "load_kwargs": {},
    "dump_kwargs": {},
    "function_name": "execute_boruta_feature_selection",
    "function_file": "<ipython-input-8-630269d5dbb9>:5",
    "args_to_ignore": [
        "X_train",
        "y_train"
    ],
    "source": "@Cache(\n    cache_path=[\n        \"/content/drive/MyDrive/Colab_Notebooks/Bioinformatica/Progetto/CNN/boruta/kept_features_{_hash}.json\",\n        \"/content/drive/MyDrive/Colab_Notebooks/Bioinformatica/Progetto/CNN/boruta/discarded_features_{_hash}.json\"\n    ],\n    args_to_ignore=[\n        \"X_train\", \"y_train\"\n    ]\n)\ndef execute_boruta_feature_selection(\n    X_train: pd.DataFrame,\n    y_train: np.ndarray,\n    holdout_number: int,\n    task_name: str,\n    max_iter: int = 100\n):\n    \"\"\"Returns tuple with list of kept features and list of discared features.\n    \n    Parameters\n    --------------------------\n    X_train: pd.DataFrame,\n        The data reserved for the input of the training of the Boruta model.\n    y_train: np.ndarray,\n        The data reserved for the output of the training of the Boruta model.\n    holdout_number: int,\n        The current holdout number.\n    regression: bool,\n        Whether the task is a binary classification one (False) or a regression one (True).\n    task_name: str,\n        The name of the task.\n    max_iter: int = 100,\n        Number of iterations to run Boruta for.\n    \"\"\"\n    # According to the requested task we build either a random forest regressor\n    # or a random forest classifier.\n    model = RandomForestClassifier(n_jobs=cpu_count(), class_weight='balanced_subsample', max_depth=5)\n    \n    # Create the Boruta model\n    boruta_selector = BorutaPy(\n        # Defining the model that Boruta should use.\n        model,\n        # We leave the number of estimators to be decided by Boruta\n        n_estimators='auto',\n        verbose=False,\n        alpha=0.05, # p_value\n        # In practice one would run at least 100-200 times,\n        # until all tentative features are exausted.\n        max_iter=max_iter, \n        random_state=42,\n    )\n    # Fit the Boruta model\n    boruta_selector.fit(X_train.values, y_train)\n    \n    # Get the kept features and discarded features\n    kept_features = list(X_train.columns[boruta_selector.support_])\n    discarded_features = list(X_train.columns[~boruta_selector.support_])\n    \n    # Filter out the unused featured.\n    return kept_features, discarded_features\n",
    "backend_metadata": {},
    "parameters": {
        "max_iter": 20,
        "holdout_number": 5,
        "task_name": "active_promoters_vs_inactive_promoters"
    }
}